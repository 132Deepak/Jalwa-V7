<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jalwa Pro Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --bg: #0d131f; --card: #1f293a; --gold: #ff9800; --blue: #2196f3; --green: #00c853; --red: #ff4d4d; }
        body { margin: 0; background: #000; font-family: 'Segoe UI', sans-serif; color: white; overflow-x: hidden; }
        .app-container { width: 100%; max-width: 480px; margin: auto; background: var(--bg); min-height: 100vh; padding-bottom: 100px; }

        /* --- HEADER --- */
        .user-top-bar { padding: 15px; background: var(--card); display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #2d3a4f; }
        .user-info-side { display: flex; align-items: center; gap: 10px; }
        .id-val { font-weight: bold; color: var(--gold); font-size: 14px; }
        .bal-side { display: flex; align-items: center; gap: 12px; }
        .bal-amount { font-size: 18px; font-weight: 800; color: #fff; }
        .refresh-btn { color: var(--gold); font-size: 18px; cursor: pointer; }

        /* --- ACTIONS --- */
        .action-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 20px 15px; }
        .action-btn { background: #252f3f; padding: 12px 5px; border-radius: 15px; text-align: center; border: 1px solid #2d3a4f; cursor: pointer; }
        .action-btn i { font-size: 20px; margin-bottom: 5px; display: block; }
        .action-btn.dep i { color: var(--green); }
        .action-btn.wit i { color: var(--blue); }
        .action-btn.sup i { color: var(--gold); }
        .action-btn span { font-size: 11px; font-weight: 600; }

        /* --- DAILY REWARD --- */
        .daily-mission { margin: 0 15px 25px 15px; background: linear-gradient(90deg, #1e3a8a, #1e40af); padding: 15px; border-radius: 18px; display: flex; justify-content: space-between; align-items: center; }

        /* --- GAMES GRID --- */
        .games-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 0 15px; }
        .game-box { background: #161e2b; border-radius: 20px; padding: 15px; text-align: center; border: 1px solid #2d3a4f; cursor: pointer; border-bottom: 4px solid transparent; }
        .game-box.wingo { border-bottom-color: var(--gold); }
        .game-box.aviator { border-bottom-color: var(--red); }
        .game-box i { font-size: 30px; margin-bottom: 8px; display: block; }
        .game-name { font-weight: bold; font-size: 14px; }

        /* --- EARN PAGE STYLES --- */
        .earn-container { padding: 20px 15px; }
        .mission-card { background: var(--card); padding: 15px; border-radius: 18px; border-left: 4px solid var(--gold); display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .btn-claim-small { background: var(--blue); color: white; border: none; padding: 8px 12px; border-radius: 8px; font-size: 11px; font-weight: bold; cursor: pointer; }
        .btn-claim-small:disabled { background: #444 !important; color: #888 !important; }

        /* NAV */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; max-width: 480px; background: #161e2b; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #2d3a4f; z-index: 1000; }
        .nav-item { text-align: center; color: #64748b; font-size: 10px; flex: 1; cursor: pointer; }
        .nav-item.active { color: var(--gold); }
        .page-view { display: none; }
        .page-view.active { display: block; }

        #customToast { visibility: hidden; background: var(--green); color: #fff; padding: 12px; border-radius: 10px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2000; font-weight: bold; }
        #customToast.show { visibility: visible; animation: fadeInOut 2s; }
        @keyframes fadeInOut { 0%, 100% {opacity:0} 20%, 80% {opacity:1} }
    </style>
</head>
<body>

<div id="customToast">Action Success!</div>

<div class="app-container">
    
    <div id="home" class="page-view active">
        <div class="user-top-bar">
            <div class="user-info-side">
                <div class="avatar" style="width:32px; height:32px; background:var(--gold); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#000; font-weight:bold;">U</div>
                <div><span style="font-size:9px; color:#888; display:block;">UID</span><span class="id-val" id="uID">...</span></div>
            </div>
            <div class="bal-side">
                <div class="bal-amount">₹<span id="mainBal">0.00</span></div>
                <i class="fas fa-sync-alt refresh-btn" onclick="location.reload()"></i>
            </div>
        </div>

        <div class="action-row">
            <div class="action-btn dep" onclick="showPage('wallet', document.querySelectorAll('.nav-item')[2])"><i class="fas fa-plus-circle"></i><span>Deposit</span></div>
            <div class="action-btn wit" onclick="showPage('wallet', document.querySelectorAll('.nav-item')[2])"><i class="fas fa-money-bill-transfer"></i><span>Withdraw</span></div>
            <div class="action-btn sup" onclick="window.open('https://t.me/yourlink')"><i class="fas fa-headset"></i><span>Support</span></div>
        </div>

        <div class="daily-mission">
            <div><div style="font-weight:bold; font-size:14px;">Daily Login Bonus</div><div style="font-size:10px; color:#ddd;">Claim ₹20 free cash</div></div>
            <button id="dailyBtn" onclick="claimDaily()" style="background:#fff; color:#1e40af; border:none; padding:8px 15px; border-radius:10px; font-weight:bold; font-size:11px;">CLAIM</button>
        </div>

        <div class="games-grid">
            <div class="game-box wingo" onclick="location.href='game.html'"><i class="fas fa-dice" style="color:var(--gold)"></i><div class="game-name">WinGo 30s</div></div>
            <div class="game-box aviator" onclick="location.href='aviator.html'"><i class="fas fa-plane-departure" style="color:var(--red)"></i><div class="game-name">Aviator</div></div>
        </div>
    </div>

    <div id="earn" class="page-view">
        <div class="earn-container">
            <div style="background:var(--card); padding:20px; border-radius:20px; text-align:center; border:1px solid var(--gold); margin-bottom: 20px;">
                <div style="font-size:15px; font-weight:bold;">Invite & Earn <span style="color:var(--gold);">₹250</span></div>
                <div style="font-size:11px; color:#bbb; margin: 10px 0;">Reward added if friend <b style="color:var(--gold);">recharges ₹500+</b></div>
                <button onclick="copyReferLink()" style="background:var(--gold); border:none; padding:12px; width:100%; border-radius:12px; font-weight:bold; color:#000;">COPY REFERRAL LINK</button>
            </div>

            <div style="font-size: 14px; font-weight: bold; color: #888; margin-bottom: 12px;">LIFETIME MISSIONS</div>

            <div class="mission-card" style="border-left-color: var(--blue);">
                <div>
                    <div style="font-weight: bold; font-size: 14px;">Recharge ₹500</div>
                    <div style="font-size: 11px; color: #888;">Claim ₹20 Bonus Cash</div>
                </div>
                <button class="btn-claim-small" id="taskRechargeBtn" onclick="claimTask('recharge')">CLAIM</button>
            </div>

            <div class="mission-card" style="border-left-color: var(--green);">
                <div>
                    <div style="font-weight: bold; font-size: 14px;">Complete 100 Bets</div>
                    <div style="font-size: 11px; color: #888;">Claim ₹20 Bonus Cash</div>
                </div>
                <button class="btn-claim-small" id="taskBetBtn" onclick="claimTask('bet')">CLAIM</button>
            </div>
        </div>
    </div>

    <div id="wallet" class="page-view">
        <div style="padding:20px; text-align: center;">
            <div style="background: linear-gradient(135deg, #1e3a8a, #1e40af); padding: 40px 20px; border-radius: 20px; margin-bottom: 20px;">
                <div style="font-size: 14px; opacity: 0.8;">Wallet Balance</div>
                <div style="font-size: 32px; font-weight: bold;">₹ <span id="walletBal">0.00</span></div>
            </div>
            <button onclick="location.href='wallet.html'" style="width:100%; padding:18px; background:var(--blue); color:white; border:none; border-radius:18px; font-weight:bold;">DEPOSIT / WITHDRAW</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="showPage('home', this)"><i class="fas fa-house"></i><br>Home</div>
        <div class="nav-item" onclick="showPage('earn', this)"><i class="fas fa-sack-dollar"></i><br>Earn</div>
        <div class="nav-item" onclick="showPage('wallet', this)"><i class="fas fa-wallet"></i><br>Wallet</div>
        <div class="nav-item" onclick="logout()"><i class="fas fa-power-off"></i><br>Logout</div>
    </div>

</div>

<script>
    const firebaseConfig = { databaseURL: "https://jalwa-v2-ad222-default-rtdb.firebaseio.com/" };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const userId = localStorage.getItem('jalwa_id');

    if(!userId) window.location.replace("login.html");

    function showToast(msg) {
        const t = document.getElementById("customToast");
        t.innerText = msg; t.className = "show";
        setTimeout(() => { t.className = ""; }, 2000);
    }

    function showPage(id, el) {
        document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    }

    window.onload = () => {
        db.ref('users/' + userId).on('value', (snap) => {
            const data = snap.val();
            if(data) {
                document.getElementById('uID').innerText = userId;
                let bal = Number(data.balance || 0).toFixed(2);
                document.getElementById('mainBal').innerText = bal;
                document.getElementById('walletBal').innerText = bal;
                
                const today = new Date().toDateString();
                if(data.lastClaim === today) {
                    document.getElementById('dailyBtn').disabled = true;
                    document.getElementById('dailyBtn').innerText = "DONE";
                }
                if(data.task500Claimed) {
                    document.getElementById('taskRechargeBtn').disabled = true;
                    document.getElementById('taskRechargeBtn').innerText = "DONE";
                }
                if(data.task100BetClaimed) {
                    document.getElementById('taskBetBtn').disabled = true;
                    document.getElementById('taskBetBtn').innerText = "DONE";
                }
            }
        });
    };

    function claimDaily() {
        db.ref('users/' + userId).once('value', (snap) => {
            const data = snap.val();
            const today = new Date().toDateString();
            if(data.lastClaim !== today) {
                db.ref('users/' + userId).update({ balance: (data.balance || 0) + 20, lastClaim: today })
                .then(() => showToast("₹20 Bonus Added!"));
            }
        });
    }

    function claimTask(type) {
        db.ref('users/' + userId).once('value', (snap) => {
            const data = snap.val();
            if(type === 'recharge') {
                if(!data.task500Claimed && data.totalRecharge >= 500) {
                    db.ref('users/' + userId).update({ balance: (data.balance || 0) + 20, task500Claimed: true });
                } else { showToast(data.task500Claimed ? "Already Claimed!" : "Recharge ₹500 first!"); }
            } else if(type === 'bet') {
                if(!data.task100BetClaimed && data.totalBets >= 100) {
                    db.ref('users/' + userId).update({ balance: (data.balance || 0) + 20, task100BetClaimed: true });
                } else { showToast(data.task100BetClaimed ? "Already Claimed!" : "Complete 100 bets!"); }
            }
        });
    }

    function copyReferLink() {
        navigator.clipboard.writeText("https://rebrand.ly/b60a27").then(() => showToast("Link Copied!"));
    }

    function logout() { localStorage.clear(); window.location.replace("login.html"); }
</script>
</body>
</html>


